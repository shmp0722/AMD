%% check Fig2a


%% load subject data
load('sub_group.mat')
load('data.mat')

%%
figure; hold on 

for ii = 1:8
    plot(data(ii,:),'-r')
end

m = mean(data(1:8,:));
plot(m,'-r','linewidth',2);

% add contorols

M  = nanmean(data(9:20,:));
plot(M,'linewidth',2,'color',[0 0 0])

SD = nanstd(data(9:20,:));
 
plot(M+2*SD,'--','color',[.4 .4 .4])
plot(M-2*SD,'--','color',[.4 .4 .4])

plot(M+SD,'--','color',[.7 .7 .7])
plot(M-SD,'--','color',[.7 .7 .7])

%% stats
% Wilcoxon signed rank test

nodes = length(data);


for jj= 1: nodes    
    
    % Wilcoxon signed rank test
    [p(jj),h(jj),~] = signrank([data(jj,1:8),nan(1,4)],data(jj,9:20));
       
    % ttest
    [H(jj),P(jj),~] = ttest2(data(jj,1:8),data(jj,9:20));
    %     co = multcompare(stats(jj),'display','off');
    %     C{jj}=co;
end

%5

